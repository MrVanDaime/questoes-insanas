<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Perguntas Insanas</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
		<style type="text/css">
			* { outline: 0!important; }
			body > div { min-height: 100vh; }
			.form-control#qtd_perguntas { background-color: #495057; }
			.accordion-button, .accordion-body {color:#fff!important;}
			.accordion-button:focus { border:none; box-shadow:none; }
			.accordion-button::after { filter: invert(0%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(190%) contrast(100%); }
		</style>
	</head>
	<body>

		<div data-bs-theme="dark" class="p-3 text-body bg-body">
			<div class="container">
				<div class="header">
					<h5 class="text-center">Quantidade de perguntas</h5>
					<div class="row g-3 my-2 justify-content-center">
						<div class="col-12 col-lg-2">
							<label for="qtd_perguntas" class="visually-hidden">Perguntas</label>
							<input type="number" class="form-control" id="qtd_perguntas" placeholder="Perguntas">
						</div>
						<div class="col-auto">
							<button type="submit" class="btn btn-primary mb-3 col-12" id="btn_gerar">Gerar</button> </div>
					</div>
				</div>
				<div class="content text-center">
					<div class="col-12 perguntas-wrap">
						<div class="accordion" id="accordionMain"></div>
					</div>
				</div>
			</div>
		</div>

	</body>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

	<script>

		const icons = "data.json";

		// Cria todos os ícones
		$.getJSON( icons, function( json ) {
			let icons_json = json;
			icons_json.forEach( function( item ) {
				console.log( item.id );
			});
		});


		const data_json = [
			{
				"id": 0,
				"pergunta": "O que é um clube 1%?",
				"resposta": "Só respeitas as leis do clube",
				"dificuldade": "facil"
			},
			{
				"id": 1,
				"pergunta": "Qual é a função do tesoureiro?",
				"resposta": "Grana",
				"dificuldade": "facil"
			},
			{
				"id": 2,
				"pergunta": "Cite 3 cargos do conselho de um moto clube.",
				"resposta": "SAA, President, Vice-president",
				"dificuldade": "facil"
			},
			{
				"id": 3,
				"pergunta": "Qual é a data de fundação do clube?",
				"resposta": "Eitakkkkkk",
				"dificuldade": "medio"
			},
			{
				"id": 4,
				"pergunta": "Quem é Jansen?",
				"resposta": "DEUS",
				"dificuldade": "dificil"
			},
		];

		const btn_gerar = $( "#btn_gerar" );
		const accordion = $( "#accordionMain" );
		$( "#qtd_perguntas" ).attr( "min", 1 );
		$( "#qtd_perguntas" ).attr( "max", data_json.length );

		btn_gerar.on( "click", function(){
			let qtd_perguntas = $( "#qtd_perguntas" ).val();

			if ( data_json.length >= qtd_perguntas && qtd_perguntas > 0 ) {
				var arr_selecionados = [];
				let html = '';
				while( arr_selecionados.length < qtd_perguntas ){
					var index = Math.floor( Math.random() * data_json.length );
					if ( !arr_selecionados.includes( data_json[index] ) ) {
						let dificuldade = data_json[index]["dificuldade"];
						switch ( dificuldade ) {
							case 'facil':
								dificuldade = 'success';
							break;
							case 'medio':
								dificuldade = 'warning';
							break;
							case 'dificil':
								dificuldade = 'danger';
							break;
						}

						arr_selecionados.push( data_json[index] );
						html += '<div class="accordion-item bg-'+dificuldade+'"><h2 class="accordion-header" id="heading'+data_json[index]["id"]+'"><button class="accordion-button collapsed bg-'+dificuldade+'" type="button" data-bs-toggle="collapse" data-bs-target="#collapse'+data_json[index]["id"]+'" aria-expanded="false" aria-controls="collapse'+data_json[index]["id"]+'"><b>'+ data_json[index]["pergunta"] +'</b></button></h2>'+
							'<div id="collapse'+data_json[index]["id"]+'" class="accordion-collapse collapse" aria-labelledby="heading'+data_json[index]["pergunta"]+'" data-bs-parent="#accordionMain"><div class="accordion-body">'+data_json[index]["resposta"]+'</div></div></div>';
					}
				}
				accordion.html( '' );
				accordion.append( html );
			} else {
				alert( "Mano?? Preenche isso aí corretamente!" );
			}
		});

	</script>
</html>